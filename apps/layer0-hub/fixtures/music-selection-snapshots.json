[
  {
    "name": "default_no_session",
    "snapshot": {
      "session": null,
      "entitlements": [],
      "offlineCache": {
        "lastValidatedAt": "2026-02-13T00:00:00.000Z",
        "maxOfflineDays": 21,
        "offlineDaysRemaining": 21,
        "cacheState": "valid"
      },
      "transactions": []
    },
    "requestedEngineId": null,
    "expected": {
      "engineId": "stub-music-intelligence-v1",
      "source": "default",
      "reason": "No session: use stub engine."
    }
  },
  {
    "name": "default_with_session",
    "snapshot": {
      "session": {
        "userId": "usr_1",
        "email": "producer@antiphon.audio",
        "displayName": "Producer",
        "signedInAt": "2026-02-13T00:00:00.000Z"
      },
      "entitlements": [],
      "offlineCache": {
        "lastValidatedAt": "2026-02-13T00:00:00.000Z",
        "maxOfflineDays": 21,
        "offlineDaysRemaining": 21,
        "cacheState": "valid"
      },
      "transactions": []
    },
    "requestedEngineId": null,
    "expected": {
      "engineId": "minimal-real-music-intelligence-v1",
      "source": "default",
      "reason": "Session present: use minimal real engine."
    }
  },
  {
    "name": "requested_unknown_fallback",
    "snapshot": {
      "session": null,
      "entitlements": [],
      "offlineCache": {
        "lastValidatedAt": "2026-02-13T00:00:00.000Z",
        "maxOfflineDays": 21,
        "offlineDaysRemaining": 21,
        "cacheState": "valid"
      },
      "transactions": []
    },
    "requestedEngineId": "unknown.engine.v1",
    "expected": {
      "engineId": "stub-music-intelligence-v1",
      "source": "default",
      "reason": "Requested engine id 'unknown.engine.v1' not found; applying deterministic default policy."
    }
  }
]
